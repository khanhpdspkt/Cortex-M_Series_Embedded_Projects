
<!-- 
<img src="https://latex.codecogs.com/gif.latex?" /> 

<img src="https://render.githubusercontent.com/render/math?math=e^{i \pi} = -1">
-->

<!-- 

<img src="https://render.githubusercontent.com/render/math?math=\LARGE XXX" />

-->

 

# Convolution

<br/><br/>

<img  style="display: block; margin-left: auto; margin-right: auto; width: 50%;" src="https://render.githubusercontent.com/render/math?math=y[n] = x[n] * h[n]" />

<br/><br/>

<img  style="display: block; margin-left: auto; margin-right: auto; width: 50%;" src="https://render.githubusercontent.com/render/math?math=\large y[n] = \sum^{\infty}_{i = - \infty} x[i]h[n - i]" />

<br/><br/>

Given implues response
```c
const float32_t impules_response[IMPLUSE_RSP_LENGTH] = { // generated by Matlab
  -0.0018225230f, -0.0015879294f, +0.0000000000f, +0.0036977508f, +0.0080754303f, +0.0085302217f, -0.0000000000f, -0.0173976984f,
  -0.0341458607f, -0.0333591565f, +0.0000000000f, +0.0676308395f, +0.1522061835f, +0.2229246956f, +0.2504960933f, +0.2229246956f,
  +0.1522061835f, +0.0676308395f, +0.0000000000f, -0.0333591565f, -0.0341458607f, -0.0173976984f, -0.0000000000f, +0.0085302217f,
  +0.0080754303f, +0.0036977508f, +0.0000000000f, -0.0015879294f, -0.0018225230f
};
```

![](https://i.imgur.com/IcVvyju.png)



## Implementation

```c
void convolution(
	float32_t *sig_src,
	float32_t *sig_dest,
	float32_t *imp_resp,
	uint32_t  sig_src_length,
	uint32_t  imp_resp_length
	) {
	uint32_t i, j;
	// initialize
	memset(sig_dest, 0, (sig_src_length + imp_resp_length)*sizeof(float32_t));

	//
	for(i = 0; i < sig_src_length; i++) {
		for(j = 0; j < imp_resp_length; j++) {
			sig_dest[i + j] += (sig_src[i] * imp_resp[j]);
		}
	}
}
```

Better way is using CMSIS-DSP apis to calculate precisely.

![](https://i.imgur.com/s0zivLo.png)


## Running sum 

* [DSP_Running_Sum](https://github.com/syokujinau/Cortex-M_Series_Embedded_Projects/tree/master/DSP_Running_Sum)

![](https://i.imgur.com/yP0CsFS.png)



```c
void calc_running_sum(float32_t* sig_src, float32_t* sig_dest, uint32_t sig_length) {
	int i;
	sig_dest[0] = sig_src[0];
	for(i = 1; i < sig_length; i++) {
		sig_dest[i] = sig_dest[i - 1] + sig_src[i];
	}
}
```

## First difference

* [DSP_First_Difference](https://github.com/syokujinau/Cortex-M_Series_Embedded_Projects/tree/master/DSP_First_Difference)

![](https://i.imgur.com/Dug8Qpv.png)


```c
void calc_first_difference(float32_t* sig_src, float32_t* sig_dest, uint32_t sig_length) {
	sig_dest[0] = 0;
	int i;
	for(i = 1; i < sig_length; i++) {
		sig_dest[i] = sig_src[i] + sig_src[i - 1];
	}
}
```















###### tags: `ARM` `Electrical Engineering` `DSP`
